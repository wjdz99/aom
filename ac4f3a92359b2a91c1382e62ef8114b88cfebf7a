{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "579ad49f_840a6a62",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 29295
      },
      "writtenOn": "2022-09-06T12:10:03Z",
      "side": 1,
      "message": "Hi Marco/Yunqing,\n\nIn this CL, we have extended the sf: reduce_mv_pel_precision_highmotion to cpu 9 rtc testset by creating a new, conservative level ( \u003d 1). The existing algo is shifted to level 2, since it was too aggressive for cpu 9.\n\nThe worst-case results for cpu 9 rtc set (including the clipwise speed-up):\n```\nClip                    BD Rate Loss (%)           Instr. Count\n                  avg.psnr   glb.psnr  aom.ssim    Reduction (%)\nmarcooffice720p     0.97       0.94      1.76        1.55  \nstreet360p          0.95       0.95      0.86        1.63\ngipsrecmotion720p   0.85       0.82      1.15        2.46\njimredvga_25fps     0.85       1.08      1.35        3.69\nmmmovingvga         0.81       0.71      1.01        3.24\n```\nThe instruction count reduction specified has been measured using command:\n $ perf stat -e instructions:u ./aomenc â€¦\n\nWe performed visual tests for marcooffice720p (800 kbps), jimredvga_25fps (400 kbps) and gipsrecmotion720p (800kbps). There are no noticeable differences or new artifacts. If we take framewise difference (ref Vs CL), generally the numerical difference is around the moving object edges. Visually, it is hardly noticeable even when we compare pairs of decoded images (ref Vs CL) side-by-side. \n\nWe also observed that the existing level 2 is too aggressive for cpu 10 rtc-derf set. Switching it to level 1 helps improve quality. For cpu 10 rtc-derf set, 15 clips show quality improvement, while 5 show quality loss. The worst/best case drops are:\n```\nClip                           BD Rate Loss (%)          \n                         avg.psnr   glb.psnr  aom.ssim   \nWorst case:\nparis_352_288             0.1041    0.0641   -0.1363\ntac_narrows_320_240       0.0852    0.3338   -0.2505\nniklas_320_240            0.0756    0.0416    0.3428\n\nBest case:\ndesktopqvga_320_240      -1.7749   -1.5388   -1.9448\nstreet180p               -1.7097   -1.7864   -1.4045\napprtc_pixel3_320_240    -1.3109   -1.4616   -1.8940\n```\n\nIf we disable it (level 0), we get the following (compared with the ref). The level 1 results are also copied for reference:\n```\n --------------------------------------------------------------------------\n| sf level |cpu | Testset | Instr. Count |    BD-Rate Drop (%)             |\n|          |    |         | Reduction(%) | avg. psnr | ovr. psnr |  ssim   |\n|     0    | 10 | rtc_derf|    -1.297    |  -0.5008  |  -0.4975  | -0.5596 |\n|     1    | 10 | rtc_derf|    -0.797    |  -0.5332   | -0.5256  | -0.6321 |\n --------------------------------------------------------------------------\n```\nAlso, level 0 has a worst-case drop for desktop1_320_180 (avg.psnr/ovr.psnr/ssim ) \u003d (0.83/0.63/0.85). Thus, we feel that level \u003d 1 may be appropriate for cpu 10 rtc-derf.\n\nWith this CL, the state of sf reduce_mv_pel_precision_highmotion for non-svc use case:\n```\ncpu    testset       sf level\n 9     rtc-derf         0 \n 9     rtc              1\n 9     rtc-screen       2\n10     rtc-derf         1\n10     rtc              2\n10     rtc-screen       2\n``` \n\nWe plan to check whether this can be tuned for cpu 7/8.\n\nPlease review the CL and let us know if any suggestions.\n\nThanks,\nNeeraj",
      "revId": "ac4f3a92359b2a91c1382e62ef8114b88cfebf7a",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ],
  "submitRequirementResults": [
    {
      "submitRequirement": {
        "name": "Code-Review",
        "description": {
          "value": "At least one maximum vote for label \u0027Code-Review\u0027 is required"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Code-Review\u003dMAX,user\u003dnon_uploader AND -label:Code-Review\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Code-Review=MAX,user=non_uploader AND -label:Code-Review=MIN"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["label:Code-Review=MAX,user=non_uploader"],"failingAtoms":["label:Code-Review=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1"]}
      },
      "patchSetCommitId": "ac4f3a92359b2a91c1382e62ef8114b88cfebf7a",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    },
    {
      "submitRequirement": {
        "name": "Review-Enforcement",
        "description": {
          "value": "Two Google employees must approve the change. Uploading the change or voting positively on Code-Review count as approval."
        },
        "applicabilityExpression": {
          "value": {
            "expressionString": "is:review-enforced_gerrit"
          }
        },
        "submittabilityExpression": {
          "expressionString": "is:review-enforcement-satisfied_gerrit"
        },
        "overrideExpression": {},
        "allowOverrideInChildProjects": false
      },
      "applicabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforced_gerrit"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["is:review-enforced_gerrit"],"failingAtoms":[]}
      },
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforcement-satisfied_gerrit"},"status":"NOT_EVALUATED","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":[]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"is:review-enforced_gerrit"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["is:review-enforcement-satisfied_gerrit"]}
      },
      "patchSetCommitId": "ac4f3a92359b2a91c1382e62ef8114b88cfebf7a",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {
        "value": true
      }
    },
    {
      "submitRequirement": {
        "name": "Verified",
        "description": {
          "value": "CI or human verified the change"
        },
        "applicabilityExpression": {},
        "submittabilityExpression": {
          "expressionString": "label:Verified\u003dMAX AND -label:Verified\u003dMIN"
        },
        "overrideExpression": {
          "value": {
            "expressionString": "label:Bot-Commit\u003d+1"
          }
        },
        "allowOverrideInChildProjects": true
      },
      "applicabilityExpressionResult": {},
      "submittabilityExpressionResult": {
        "value": {"expression":{"expressionString":"label:Verified=MAX AND -label:Verified=MIN"},"status":"PASS","errorMessage":{"value":null},"passingAtoms":["label:Verified=MAX"],"failingAtoms":["label:Verified=MIN"]}
      },
      "overrideExpressionResult": {
        "value": {"expression":{"expressionString":"label:Bot-Commit=+1"},"status":"FAIL","errorMessage":{"value":null},"passingAtoms":[],"failingAtoms":["label:Bot-Commit=+1"]}
      },
      "patchSetCommitId": "ac4f3a92359b2a91c1382e62ef8114b88cfebf7a",
      "legacy": {
        "value": false
      },
      "forced": {},
      "hidden": {}
    }
  ]
}
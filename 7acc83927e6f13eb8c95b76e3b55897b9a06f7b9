{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "8a652faf_987be57f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-07-12T22:54:24Z",
      "side": 1,
      "message": "Why does this CL affect speed \u003e\u003d 3? I don\u0027t see any code that checks the speed in this CL, so this is not obvious to me.\n\nIs it because the av1_rd_pick_palette_intra_sby() function is only used by speed \u003e\u003d 3?\n\nThanks a lot!",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "08fcaf08_263e4b87",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 22433
      },
      "writtenOn": "2021-07-13T17:05:34Z",
      "side": 1,
      "message": "As prune_palette_search_level is set to 2 for speed\u003e\u003d3 for both \u0027good\u0027 and \u0027allintra\u0027 encoding mode this CL affects speed \u003e\u003d 3. We have changed the commit msg for better understanding.",
      "parentUuid": "8a652faf_987be57f",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "947552e9_89e2f7cb",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-07-16T23:23:14Z",
      "side": 1,
      "message": "Thanks for the reply. I indicate my remaining question in av1/encoder/palette.c.",
      "parentUuid": "08fcaf08_263e4b87",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8912fb0b_c08c7d64",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 45,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-07-12T22:38:46Z",
      "side": 1,
      "message": "Please remove aomedia:2959. (I marked aomedia:2959 Fixed today.)",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ed984b97_cee27ffe",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 45,
      "author": {
        "id": 22433
      },
      "writtenOn": "2021-07-13T17:05:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8912fb0b_c08c7d64",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "728d7ab9_ab229442",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 22433
      },
      "writtenOn": "2021-07-12T16:06:29Z",
      "side": 1,
      "message": "Hi Wan-Teh, Chi Yo, Cheng Chen,\n\nIn this CL, we have changed the order of luma palette_size evaluation in av1_rd_pick_palette_intra_sby() for prune_palette_search_level equal to 2 (which applies for speed \u003e\u003d 3). The current ascending order followed by descending order has been modified/changed to ascending order followed by descending order. This re-ordering facilitates early exit based on palette header rdcost for speed \u003e\u003d 3.\n\nAs per our understanding, starting with ascending order followed by descending order (current CL) prefers to choose lower palette size\u0027s (compared to that of base version where higher palette sizes are preferred), which are helping in improving the bd-rate at higher qp points because of lower rate.\n\nThis change is verified to be bit-exact for still image, allintra and good encoding for speeds \u003c\u003d 2.\n\nFollowing are instruction count reduction results when AVIF encode was tested for a typical image dataset.\n\nwith --tune\u003dpsnr,\n          Instruction Count    BD-Rate Loss(%)\ncpu-used     Reduction(%)      psnr       ssim\n   3           -0.004         -0.0030    -0.0116\n   4            0.004         -0.0030    -0.0055\n   5           -0.002         -0.0049    -0.0085\n   6           -0.007         -0.0061    -0.0173\n   7           -0.002         -0.0057    -0.0109\n   8           -0.003         -0.0020    -0.0028\n\nwith --tune\u003dssim,\n          Instruction Count    BD-Rate Loss(%)\ncpu-used     Reduction(%)      psnr       ssim\n   3           -0.002          0.0014     0.0011\n   4           -0.003         -0.0016     0.0016\n   5           -0.001         -0.0024    -0.0059\n   6           -0.002         -0.0038    -0.0134\n   7           -0.002         -0.0014    -0.0021\n   8           -0.003         -0.0008    -0.0014\n\nFollowing are instruction count reduction results when allintra video encode was tested for the screen content test set.\n\n          Instruction Count        BD-Rate Loss(%)\ncpu-used     Reduction(%)   avg.psnr  ovr.psnr  ssim\n   3          -0.040       -0.1802   -0.1811   -0.7997\n   4          -0.055       -0.2912   -0.2835   -1.0394\n   5           0.023       -0.3423   -0.3413   -1.0311\n   6          -0.157       -0.3567   -0.3550   -0.7304\n\nFollowing are instruction count reduction results when good video encode was tested for the screen content test set.\n\n          Instruction Count        BD-Rate Loss(%)\ncpu-used     Reduction(%)   avg.psnr  ovr.psnr  ssim\n   3          -1.034       -0.5324  -0.5500    -0.8091\n   4           0.051       -0.1340  -0.1007    -0.1401\n   5          -0.046        0.0997   0.0828     0.1359\n   6          -0.252        0.0895   0.0500    -0.1844\n\nThe patch which enables early exit in palette_size search based on header rdcost in speed \u003e\u003d3 path is submitted as a dependent patch at the link mentioned below:\nhttps://aomedia-review.googlesource.com/c/aom/+/141683\n\nIn the commit message, BD rate impact column:\n[+] sign is for BD-Rate drop\n[-] sign is for BD-Rate improvement\nThe instruction count reduction specified has been measured using command:\n$ perf stat -e instructions:u ./avifenc â€¦\n\nPlease review.\n\nRegards,\nAniket.",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "268a34a6_36db51e7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 9545
      },
      "writtenOn": "2021-07-12T22:38:46Z",
      "side": 1,
      "message": "Hi Aniket,\n\nThanks for the CL. Since this CL depends on two other CLs that are still being reviewed, I will wait until the dependent CLs have been committed to review this one.",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "591982bc_e7a8b01a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 22433
      },
      "writtenOn": "2021-07-13T17:05:34Z",
      "side": 1,
      "message": "As patch for \u0027Change the evaluation order of luma palette_size in speed 0\u0027 (https://aomedia-review.googlesource.com/c/aom/+/141261) has been merged, we have rebased current CL on top of above such that there are no dependencies on other CLs.",
      "parentUuid": "268a34a6_36db51e7",
      "revId": "7acc83927e6f13eb8c95b76e3b55897b9a06f7b9",
      "serverId": "e5514cf8-2d6e-3e29-adb4-24cd6dde4bf0"
    }
  ]
}